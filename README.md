# HentaiChan Parser
**HentaiChan Parser** – это кроссплатформенный скрипт для получения данных с сайта [HentaiChan](https://hentaichan.live) в формате JSON. Он позволяет записать всю информацию о конкретной манге, а также её главах и содержании глав. Файлы на выходе совместимы с парсером [MangaLib Parser](https://github.com/DUB1401/MangaLibParser) и парсером API сайта [ReManga](https://remanga.org/).
## Порядок установки и использования
1. Установить Python версии не старше 3.9. При установке рекомендуется добавить в PATH.
2. Скачать [Google Chrome](https://www.google.by/intl/ru/chrome/) и установить в директорию по умолчанию.
3. В среду исполнения установить следующие пакеты вручную или при помощи файла _requirements.txt_: webdriver-manager, BeautifulSoup4, Selenium, lxml.
```
pip install webdriver-manager
pip install BeautifulSoup4
pip install Selenium
pip install lxml
```
4. Настроить скрипт путём редактирования *Settings.json*.
5. Открыть директорию со скриптом в консоли. Можно использовать метод `cd` и прописать путь к папке, либо открыть терминал из проводника.
6. Ввести нужную команду и дождаться завершения. Не сворачивайте браузер, так как это может привести к исключениям области видимости.

**Важно:** В зависимости от ОС может потребоваться полное написание названия главного файла. Например, на Windows 11 достаточно `hcp`, в то время как на Windows 10 необходимо использовать `hcp.py`.
# Консольные команды
```
hcp scan [CHAPTER_ID]
```
Получает определение главы и записывает его в файл _#Definitions.json_. Для последующего парсинга глав наличие локального определения необходимо.

ID главы можно узнать из адресной строки браузера на соответствующей странице. Также, вместо ID, можно передать другие аргументы, модифицирующие поведение функции.

**Список дополнительных аргументов:**
* _**-all**_ – сканирует определения со всего сайта;
* _**-new**_ – сканирует определения начиная с последнего, пока не встретит уже описанную главу;
* _**-target**_ – запускает функцию с аргументом из _Settings.json_.

В дополнение к вышеперечисленным аргументам возможна активация флагов.

**Список специфических флагов:**
* _**-f**_ – включает перезапись уже существующих файлов.
____
```
hcp getsl [CHAPTER_ID]
```
Получает список слайдов главы и сохраняет их в директорию _chapters_ под названием _[CHAPTER_ID].json_ для последующего использования другими фугкциями.
____
```
hcp chtest
```
Запускает тест [Chrome Headless Detection](https://intoli.com/blog/not-possible-to-block-chrome-headless/chrome-headless-test.html) и выводит его результаты в консоль.
____
```
hcp -s
```
Флаг _**-s**_ выключает компьютер после завершения работы скрипта. Его можно добавить к любой другой команде.

# Settings.json

```
"directory" : ""
```
Задаёт рабочую директорию. Сюда будут сохраняться готовые файлы манги.
____
```
"scan-target" : ""
```
Задаёт аргумент, который может быть использован функцией `mlp scan [CHAPTER_ID]`.

____
```
"login": "",
"password": ""
```
Указывает логин и пароль для входа на сайт. Если одно из значений пусто, авторизация проводиться не будет.
____
```
"delay": 5
```
Устанавливает интервал в секундах между запросами к сайту, такими как перелистывание слайдов, с целью уменьшения нагрузки на сервера. Также помогает избежать блокировки по IP за быстрые автоматические запросы. 

Рекомендуемое значение: не менее 5 секунд.
____
```
"getting-slide-sizes": false
```
Переключатель, отвечающий за получение размеров слайдов в пикселях. Также будет проверять слайды на целостность по условию: если размер не удалось получить, значит слайд неисправен.

*Evolv Group. Copyright © 2018-2022.*
